---
title: "Wheeling Creek Ecoli Site by site"
author: "James Wood"
date: "9/29/2020"
output: html_document
---

## Library
````{r}
library(ggplot2)
library(ggmap)
library(psych)          
library(nlme)
library(lme4)

library(MuMIn)
library(AICcmodavg)
library(MASS)
```

## Water Chem Predictors by site



left off working on complete cases of a subset of predictor variables to use for dredge modeling

## Ranch Bar Sites
```{r}
WCD<- Wheeling_Creek_Data_Copy[c(1:444),c(1:10,12:14,20:24)]
RB <- subset(WCD, WCD$Site == "Ranch Bar")
```
# so there is a problem with this subset of models is that they are not all complete cases of variables, so that creats so issues. So below I made complete cases of the data ( unfortuantly this tossed out a lot of data and we may be able to get some back (talk to me about this later), but with the complete cases we can run lm models and get some solid results)


```{r}

RB[complete.cases(RB), ] # Keep only the complete rows
RB1 <- RB[complete.cases(RB), ] # Store the complete cases subset in a new data frame



# Having trouble getting this to run, not sure why. VIF makes sure you don't have variables that are colinear. 
ranchVIF <- data.frame(
                 scale(RB1$DO) + 
                 scale(RB1$Temp) + 
                 scale(RB1$Turbidity) +
                 scale(RB1$H) +
                 scale(RB1$Prev_rain_cm) +
                 scale(RB1$Rain_cm) +
                 scale(RB1$SPC) +
                 scale(RB1$Flow_mean) +
                 scale(RB1$Flow_max) + 
                 scale(RB1$Flow_min))
ranch.VIF<-stepVIF(ranchVIF, th=10)
```


## Ranch LM   So this is the LM for ranch bar sites with only complete cases. I had to drop out chloride because there were so few measurements with chloride (I have an idea about how to bring it back) but with the remaining data, here are the model results. Given the number of sampling sites, I think limiting the model selection process to two or fewer is pertinent. 
```{r}


Ranch.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~  1, data=RB1)
Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Temp),data=RB1)
Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(DO), data=RB1)
Ranch.Ecoli.models[[4]]  <- lm( E_coli_MPN ~ scale(SPC), data=RB1)
Ranch.Ecoli.models[[5]]  <- lm( E_coli_MPN ~ scale(H), data=RB1)
#Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm), data=RB1)
Ranch.Ecoli.models[[7]]  <- lm( E_coli_MPN ~ scale(Rain_cm), data=RB1)
Ranch.Ecoli.models[[8]]  <- lm( E_coli_MPN ~ scale(Flow_mean), data=RB1)
Ranch.Ecoli.models[[9]]  <- lm( E_coli_MPN ~ scale(Flow_max), data=RB1)
Ranch.Ecoli.models[[10]]  <- lm( E_coli_MPN ~ scale(Flow_min), data=RB1)


Ranch.Ecoli.models[[11]]  <- lm( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[12]]  <- lm( E_coli_MPN ~ scale(DO)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[13]]  <- lm( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[14]]  <- lm( E_coli_MPN ~ scale(H)+ scale(Turbidity) , data=RB1)
#Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) , data=ranch)
Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[16]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[17]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[18]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) , data=RB1)
Ranch.Ecoli.models[[19]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) , data=RB1)


Ranch.Ecoli.models[[20]]  <- lm( E_coli_MPN ~ scale(DO) + scale(Temp), data=RB1)
Ranch.Ecoli.models[[21]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(Temp) , data=RB1)
Ranch.Ecoli.models[[22]]  <- lm( E_coli_MPN ~ scale(H) + scale(Temp), data=RB1)
#Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(Temp), data=ranch)
Ranch.Ecoli.models[[23]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp), data=RB1)
Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp), data=RB1)
Ranch.Ecoli.models[[25]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp), data=RB1)
Ranch.Ecoli.models[[26]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Temp), data=RB1)
Ranch.Ecoli.models[[27]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Temp), data=RB1)


Ranch.Ecoli.models[[28]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(DO), data=RB1)
Ranch.Ecoli.models[[29]]  <- lm( E_coli_MPN ~ scale(H) + scale(DO) , data=RB1)
#Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(DO) , data=ranch)
Ranch.Ecoli.models[[30]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO), data=RB1)
Ranch.Ecoli.models[[31]]  <- lm( E_coli_MPN ~ scale(Rain_cm) + scale(DO), data=RB1)
Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Flow_mean) + scale(DO) , data=RB1)
Ranch.Ecoli.models[[33]]  <- lm( E_coli_MPN ~ scale(Flow_max) + scale(DO) , data=RB1)
Ranch.Ecoli.models[[34]]  <- lm( E_coli_MPN ~ scale(Flow_min) + scale(DO) , data=RB1)


Ranch.Ecoli.models[[35]]  <- lm( E_coli_MPN ~ scale(H)+ scale(SPC), data=RB1)
#Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(SPC), data=ranch)
Ranch.Ecoli.models[[36]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC), data=RB1)
Ranch.Ecoli.models[[37]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC), data=RB1)
Ranch.Ecoli.models[[38]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC), data=RB1)
Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(SPC), data=RB1)
Ranch.Ecoli.models[[40]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(SPC), data=RB1)


#Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(H), data=ranch)
Ranch.Ecoli.models[[41]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H), data=RB1)
Ranch.Ecoli.models[[42]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(H), data=RB1)
Ranch.Ecoli.models[[43]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(H), data=RB1)
Ranch.Ecoli.models[[44]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(H), data=RB1)
Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(H), data=RB1)


#Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Rain_cm) +scale(Cl), data=ranch)
#Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_max)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+scale(Cl), data=ranch)

Ranch.Ecoli.models[[46]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm), data=RB1)
Ranch.Ecoli.models[[47]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm), data=RB1)
Ranch.Ecoli.models[[48]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm), data=RB1)
Ranch.Ecoli.models[[49]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm), data=RB1)


Ranch.Ecoli.models[[50]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm), data=RB1)
Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm), data=RB1)
Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm), data=RB1)


Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean), data=RB1)
Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean), data=RB1)


Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max), data=RB1)




Mods.Ranch.Ecoli <- paste("model", 1:length(Ranch.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = Ranch.Ecoli.models, modnames = Mods.Ranch.Ecoli, sort = TRUE)

# the top model is model 1. Unfortuantly when I check the residuals three points are way out of bounds. We may need to remove those points from the data set, but you can see the outliers pertty clear and we can understand how they are effecting our model. 

# the next best model is 11, which includes temp, temp doesn't appear significant, and including the variable doesn't add much to our model.

# conclusion - the best predictor of E.coli at Ranch bar is turbidity. 

summary(Ranch.Ecoli.models[[1]])
summary(Ranch.Ecoli.models[[11]])

plot(E_coli_MPN~Turbidity, data=RB1)
abline(lm(E_coli_MPN~Turbidity, data=RB1))

```


## LMER Below here is the template for LMER - don't think is actually needed 09/24/2020. I left this in here to think about, but I'm getting a lot of Boundary Singularity error I.e. the model marginal R2 and condition R2 are not different, basically the model isn't able to estiamte the random effect, i.e. month. 
```{r}
Ranch.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
Ranch.Ecoli.models[[1]]  <- lmer( E_coli_MPN ~  (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[2]]  <- lmer( E_coli_MPN ~ scale(Turbidity) + (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[3]]  <- lmer( E_coli_MPN ~ scale(Temp)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[4]]  <- lmer( E_coli_MPN ~ scale(DO)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[5]]  <- lmer( E_coli_MPN ~ scale(SPC)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[6]]  <- lmer( E_coli_MPN ~ scale(H)+ (1| Month), data=RB1, REML= FALSE)
#Ranch.Ecoli.models[[6]]  <- lmer( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[7]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[8]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[9]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[10]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ (1| Month), data=RB1, REML= FALSE)
Ranch.Ecoli.models[[11]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ (1| Month), data=RB1, REML= FALSE)


Ranch.Ecoli.models[[12]]  <- lmer( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[13]]  <- lmer( E_coli_MPN ~ scale(DO)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[14]]  <- lmer( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[15]]  <- lmer( E_coli_MPN ~ scale(H)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[16]]  <- lmer( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[17]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[18]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[19]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[20]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[21]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) +(1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[22]]  <- lmer( E_coli_MPN ~ scale(DO) + scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[23]]  <- lmer( E_coli_MPN ~ scale(SPC) + scale(Temp) + (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[24]]  <- lmer( E_coli_MPN ~ scale(H) + scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[25]]  <- lmer( E_coli_MPN ~ scale(Cl) + scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[26]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[27]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[28]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[29]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(Temp)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[30]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Temp)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[31]]  <- lmer( E_coli_MPN ~ scale(SPC) + scale(DO)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[32]]  <- lmer( E_coli_MPN ~ scale(H) + scale(DO) + (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[33]]  <- lmer( E_coli_MPN ~ scale(Cl) + scale(DO) + (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[34]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[35]]  <- lmer( E_coli_MPN ~ scale(Rain_cm) + scale(DO)+(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[36]]  <- lmer( E_coli_MPN ~ scale(Flow_mean) + scale(DO) + (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[37]]  <- lmer( E_coli_MPN ~ scale(Flow_max) + scale(DO) + (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[38]]  <- lmer( E_coli_MPN ~ scale(Flow_min) + scale(DO) + (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[39]]  <- lmer( E_coli_MPN ~ scale(H)+ scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[40]]  <- lmer( E_coli_MPN ~ scale(Cl) + scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[41]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[42]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[43]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[44]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(SPC)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[45]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(SPC)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[46]]  <- lmer( E_coli_MPN ~ scale(Cl)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[47]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[48]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[49]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[50]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[51]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(H)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[52]]  <- lmer( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[53]]  <- lmer( E_coli_MPN ~ scale(Rain_cm) +scale(Cl)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[54]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+scale(Cl)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[55]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+scale(Cl)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[56]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+scale(Cl)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[57]]  <- lmer( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm)+(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[58]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[59]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[60]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[61]]  <- lmer( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[62]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm)+ (1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[63]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm)+ (1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[64]]  <- lmer( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean)+(1| Month), data=ranch, REML= FALSE)
Ranch.Ecoli.models[[65]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean)+(1| Month), data=ranch, REML= FALSE)


Ranch.Ecoli.models[[66]]  <- lmer( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max)+(1| Month), data=ranch, REML= FALSE)




Mods.Ranch.Ecoli <- paste("model", 1:length(Ranch.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = Ranch.Ecoli.models, modnames = Mods.Ranch.Ecoli, sort = TRUE)

r.squaredGLMM(Ranch.Ecoli.models[[2]])
```
County Line 
```{r}
WCD<- Wheeling_Creek_Data_Copy[c(1:444),c(1:10,12:14,20:24)]
WA <- subset(WCD, WCD$Site == "Washington Ave")


WA[complete.cases(WA), ] # Keep only the complete rows
WA1 <- WA[complete.cases(WA), ] # Store the complete cases subset in a new data frame

WV.ecoli <- lmer(E_coli_MPN ~ scale(DO) + 
                 scale(Temp) + 
                 scale(Turbidity) +
                 scale(Cl) +
                 scale(H) +
                 scale(Prev_rain_cm) +
                 scale(Rain_cm) +
                 scale(SPC) +
                 scale(Flow_mean) +
                 scale(Flow_max) + 
                 scale(Flow_min)
                 , data=ranch, na.action = "na.fail",
               control = lmerControl(optCtrl = list(maxfun=20000)))
mod50 <- dredge(resp50)
mod1_50 <- model.avg(get.models(mod50, subset = TRUE))
summary(mod1_50)

# need to check a stepVIF for Ranch Bar
ranchVIF <- data.frame(
                 scale(RB1$DO) + 
                 scale(RB1$Temp) + 
                 scale(RB1$Turbidity) +
                 scale(RB1$H) +
                 scale(RB1$Prev_rain_cm) +
                 scale(RB1$Rain_cm) +
                 scale(RB1$SPC) +
                 scale(RB1$Flow_mean) +
                 scale(RB1$Flow_max) + 
                 scale(RB1$Flow_min))
ranch.VIF<-stepVIF(ranchVIF, th=10)


# so the problem with this subset of models is that they are not all complete cases of variables

WA.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~  1, data=RB1)
WA.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Temp),data=WA1)
WA.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(DO), data=WA1)
WA.Ecoli.models[[4]]  <- lm( E_coli_MPN ~ scale(SPC), data=WA1)
WA.Ecoli.models[[5]]  <- lm( E_coli_MPN ~ scale(H), data=WA1)
#Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
WA.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[7]]  <- lm( E_coli_MPN ~ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[8]]  <- lm( E_coli_MPN ~ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[9]]  <- lm( E_coli_MPN ~ scale(Flow_max), data=WA1)
WA.Ecoli.models[[10]]  <- lm( E_coli_MPN ~ scale(Flow_min), data=WA1)


WA.Ecoli.models[[11]]  <- lm( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[12]]  <- lm( E_coli_MPN ~ scale(DO)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[13]]  <- lm( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[14]]  <- lm( E_coli_MPN ~ scale(H)+ scale(Turbidity) , data=WA1)
#Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) , data=ranch)
WA.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[16]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[17]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[18]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[19]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) , data=WA1)


WA.Ecoli.models[[20]]  <- lm( E_coli_MPN ~ scale(DO) + scale(Temp), data=WA1)
WA.Ecoli.models[[21]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(Temp) , data=WA1)
WA.Ecoli.models[[22]]  <- lm( E_coli_MPN ~ scale(H) + scale(Temp), data=WA1)
#Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(Temp), data=ranch)
WA.Ecoli.models[[23]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp), data=WA1)
WA.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp), data=WA1)
WA.Ecoli.models[[25]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp), data=WA1)
WA.Ecoli.models[[26]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Temp), data=WA1)
WA.Ecoli.models[[27]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Temp), data=WA1)


WA.Ecoli.models[[28]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(DO), data=WA1)
WA.Ecoli.models[[29]]  <- lm( E_coli_MPN ~ scale(H) + scale(DO) , data=WA1)
#Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(DO) , data=ranch)
WA.Ecoli.models[[30]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[31]]  <- lm( E_coli_MPN ~ scale(Rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Flow_mean) + scale(DO) , data=WA1)
WA.Ecoli.models[[33]]  <- lm( E_coli_MPN ~ scale(Flow_max) + scale(DO) , data=WA1)
WA.Ecoli.models[[34]]  <- lm( E_coli_MPN ~ scale(Flow_min) + scale(DO) , data=WA1)


WA.Ecoli.models[[35]]  <- lm( E_coli_MPN ~ scale(H)+ scale(SPC), data=WA1)
#Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(SPC), data=ranch)
WA.Ecoli.models[[36]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC), data=WA1)
WA.Ecoli.models[[37]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC), data=WA1)
WA.Ecoli.models[[38]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC), data=WA1)
WA.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(SPC), data=WA1)
WA.Ecoli.models[[40]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(SPC), data=WA1)


#Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(H), data=ranch)
WA.Ecoli.models[[41]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[42]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[43]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(H), data=WA1)
WA.Ecoli.models[[44]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(H), data=WA1)
WA.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(H), data=WA1)


#Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Rain_cm) +scale(Cl), data=ranch)
#Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_max)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+scale(Cl), data=ranch)

WA.Ecoli.models[[46]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[47]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[48]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[49]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm), data=WA1)


WA.Ecoli.models[[50]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm), data=WA1)


WA.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean), data=WA1)

WA.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max), data=WA1)




Mods.WA.Ecoli <- paste("model", 1:length(WA.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = WA.Ecoli.models, modnames = Mods.WA.Ecoli, sort = TRUE)

summary(WA.Ecoli.models[[7]])
summary(WA.Ecoli.models[[52]])

plot(E_coli_MPN~Rain_cm, data=WA1)
abline(lm(E_coli_MPN~Rain_cm, data=WA1))

plot(E_coli_MPN~Flow_min, data=WA1)
abline(lm(E_coli_MPN~Flow_min, data=WA1))

```
#
#
#####
```{r}
WCD<- Wheeling_Creek_Data_Copy[c(1:444),c(1:10,12:14,20:24)]
WA <- subset(WCD, WCD$Site == "Washington Ave")


WA[complete.cases(WA), ] # Keep only the complete rows
WA1 <- WA[complete.cases(WA), ] # Store the complete cases subset in a new data frame

WV.ecoli <- lmer(E_coli_MPN ~ scale(DO) + 
                 scale(Temp) + 
                 scale(Turbidity) +
                 scale(Cl) +
                 scale(H) +
                 scale(Prev_rain_cm) +
                 scale(Rain_cm) +
                 scale(SPC) +
                 scale(Flow_mean) +
                 scale(Flow_max) + 
                 scale(Flow_min)
                 , data=ranch, na.action = "na.fail",
               control = lmerControl(optCtrl = list(maxfun=20000)))
mod50 <- dredge(resp50)
mod1_50 <- model.avg(get.models(mod50, subset = TRUE))
summary(mod1_50)

# need to check a stepVIF for Ranch Bar
ranchVIF <- data.frame(
                 scale(RB1$DO) + 
                 scale(RB1$Temp) + 
                 scale(RB1$Turbidity) +
                 scale(RB1$H) +
                 scale(RB1$Prev_rain_cm) +
                 scale(RB1$Rain_cm) +
                 scale(RB1$SPC) +
                 scale(RB1$Flow_mean) +
                 scale(RB1$Flow_max) + 
                 scale(RB1$Flow_min))
ranch.VIF<-stepVIF(ranchVIF, th=10)


# so the problem with this subset of models is that they are not all complete cases of variables

WA.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~  1, data=RB1)
WA.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Temp),data=WA1)
WA.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(DO), data=WA1)
WA.Ecoli.models[[4]]  <- lm( E_coli_MPN ~ scale(SPC), data=WA1)
WA.Ecoli.models[[5]]  <- lm( E_coli_MPN ~ scale(H), data=WA1)
#Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
WA.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[7]]  <- lm( E_coli_MPN ~ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[8]]  <- lm( E_coli_MPN ~ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[9]]  <- lm( E_coli_MPN ~ scale(Flow_max), data=WA1)
WA.Ecoli.models[[10]]  <- lm( E_coli_MPN ~ scale(Flow_min), data=WA1)


WA.Ecoli.models[[11]]  <- lm( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[12]]  <- lm( E_coli_MPN ~ scale(DO)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[13]]  <- lm( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[14]]  <- lm( E_coli_MPN ~ scale(H)+ scale(Turbidity) , data=WA1)
#Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) , data=ranch)
WA.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[16]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[17]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[18]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[19]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) , data=WA1)


WA.Ecoli.models[[20]]  <- lm( E_coli_MPN ~ scale(DO) + scale(Temp), data=WA1)
WA.Ecoli.models[[21]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(Temp) , data=WA1)
WA.Ecoli.models[[22]]  <- lm( E_coli_MPN ~ scale(H) + scale(Temp), data=WA1)
#Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(Temp), data=ranch)
WA.Ecoli.models[[23]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp), data=WA1)
WA.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp), data=WA1)
WA.Ecoli.models[[25]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp), data=WA1)
WA.Ecoli.models[[26]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Temp), data=WA1)
WA.Ecoli.models[[27]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Temp), data=WA1)


WA.Ecoli.models[[28]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(DO), data=WA1)
WA.Ecoli.models[[29]]  <- lm( E_coli_MPN ~ scale(H) + scale(DO) , data=WA1)
#Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(DO) , data=ranch)
WA.Ecoli.models[[30]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[31]]  <- lm( E_coli_MPN ~ scale(Rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Flow_mean) + scale(DO) , data=WA1)
WA.Ecoli.models[[33]]  <- lm( E_coli_MPN ~ scale(Flow_max) + scale(DO) , data=WA1)
WA.Ecoli.models[[34]]  <- lm( E_coli_MPN ~ scale(Flow_min) + scale(DO) , data=WA1)


WA.Ecoli.models[[35]]  <- lm( E_coli_MPN ~ scale(H)+ scale(SPC), data=WA1)
#Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(SPC), data=ranch)
WA.Ecoli.models[[36]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC), data=WA1)
WA.Ecoli.models[[37]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC), data=WA1)
WA.Ecoli.models[[38]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC), data=WA1)
WA.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(SPC), data=WA1)
WA.Ecoli.models[[40]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(SPC), data=WA1)


#Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(H), data=ranch)
WA.Ecoli.models[[41]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[42]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[43]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(H), data=WA1)
WA.Ecoli.models[[44]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(H), data=WA1)
WA.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(H), data=WA1)


#Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Rain_cm) +scale(Cl), data=ranch)
#Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_max)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+scale(Cl), data=ranch)

WA.Ecoli.models[[46]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[47]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[48]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[49]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm), data=WA1)


WA.Ecoli.models[[50]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm), data=WA1)


WA.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean), data=WA1)

WA.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max), data=WA1)




Mods.WA.Ecoli <- paste("model", 1:length(WA.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = WA.Ecoli.models, modnames = Mods.WA.Ecoli, sort = TRUE)

summary(WA.Ecoli.models[[7]])
summary(WA.Ecoli.models[[52]])

plot(E_coli_MPN~Rain_cm, data=WA1)
abline(lm(E_coli_MPN~Rain_cm, data=WA1))

plot(E_coli_MPN~Flow_min, data=WA1)
abline(lm(E_coli_MPN~Flow_min, data=WA1))





###
#
#
#
#
#
#
```

## Washington Ave Site , Data = WA1, having 
left off working on complete cases of a subset of predictor variables to use for dredge modeling

```{r}
WCD<- Wheeling_Creek_Data_Copy[c(1:444),c(1:10,12:14,20:24)]
WA <- subset(WCD, WCD$Site == "Washington Ave")


WA[complete.cases(WA), ] # Keep only the complete rows
WA1 <- WA[complete.cases(WA), ] # Store the complete cases subset in a new data frame

WV.ecoli <- lmer(E_coli_MPN ~ scale(DO) + 
                 scale(Temp) + 
                 scale(Turbidity) +
                 scale(Cl) +
                 scale(H) +
                 scale(Prev_rain_cm) +
                 scale(Rain_cm) +
                 scale(SPC) +
                 scale(Flow_mean) +
                 scale(Flow_max) + 
                 scale(Flow_min)
                 , data=ranch, na.action = "na.fail",
               control = lmerControl(optCtrl = list(maxfun=20000)))
mod50 <- dredge(resp50)
mod1_50 <- model.avg(get.models(mod50, subset = TRUE))
summary(mod1_50)

# need to check a stepVIF for Ranch Bar
ranchVIF <- data.frame(
                 scale(RB1$DO) + 
                 scale(RB1$Temp) + 
                 scale(RB1$Turbidity) +
                 scale(RB1$H) +
                 scale(RB1$Prev_rain_cm) +
                 scale(RB1$Rain_cm) +
                 scale(RB1$SPC) +
                 scale(RB1$Flow_mean) +
                 scale(RB1$Flow_max) + 
                 scale(RB1$Flow_min))
ranch.VIF<-stepVIF(ranchVIF, th=10)


# so the problem with this subset of models is that they are not all complete cases of variables

WA.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~  1, data=RB1)
WA.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Temp),data=WA1)
WA.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(DO), data=WA1)
WA.Ecoli.models[[4]]  <- lm( E_coli_MPN ~ scale(SPC), data=WA1)
WA.Ecoli.models[[5]]  <- lm( E_coli_MPN ~ scale(H), data=WA1)
#Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
WA.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[7]]  <- lm( E_coli_MPN ~ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[8]]  <- lm( E_coli_MPN ~ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[9]]  <- lm( E_coli_MPN ~ scale(Flow_max), data=WA1)
WA.Ecoli.models[[10]]  <- lm( E_coli_MPN ~ scale(Flow_min), data=WA1)


WA.Ecoli.models[[11]]  <- lm( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[12]]  <- lm( E_coli_MPN ~ scale(DO)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[13]]  <- lm( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[14]]  <- lm( E_coli_MPN ~ scale(H)+ scale(Turbidity) , data=WA1)
#Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) , data=ranch)
WA.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[16]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[17]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[18]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) , data=WA1)
WA.Ecoli.models[[19]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) , data=WA1)


WA.Ecoli.models[[20]]  <- lm( E_coli_MPN ~ scale(DO) + scale(Temp), data=WA1)
WA.Ecoli.models[[21]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(Temp) , data=WA1)
WA.Ecoli.models[[22]]  <- lm( E_coli_MPN ~ scale(H) + scale(Temp), data=WA1)
#Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(Temp), data=ranch)
WA.Ecoli.models[[23]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp), data=WA1)
WA.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp), data=WA1)
WA.Ecoli.models[[25]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp), data=WA1)
WA.Ecoli.models[[26]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Temp), data=WA1)
WA.Ecoli.models[[27]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Temp), data=WA1)


WA.Ecoli.models[[28]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(DO), data=WA1)
WA.Ecoli.models[[29]]  <- lm( E_coli_MPN ~ scale(H) + scale(DO) , data=WA1)
#Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(DO) , data=ranch)
WA.Ecoli.models[[30]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[31]]  <- lm( E_coli_MPN ~ scale(Rain_cm) + scale(DO), data=WA1)
WA.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Flow_mean) + scale(DO) , data=WA1)
WA.Ecoli.models[[33]]  <- lm( E_coli_MPN ~ scale(Flow_max) + scale(DO) , data=WA1)
WA.Ecoli.models[[34]]  <- lm( E_coli_MPN ~ scale(Flow_min) + scale(DO) , data=WA1)


WA.Ecoli.models[[35]]  <- lm( E_coli_MPN ~ scale(H)+ scale(SPC), data=WA1)
#Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(SPC), data=ranch)
WA.Ecoli.models[[36]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC), data=WA1)
WA.Ecoli.models[[37]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC), data=WA1)
WA.Ecoli.models[[38]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC), data=WA1)
WA.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(SPC), data=WA1)
WA.Ecoli.models[[40]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(SPC), data=WA1)


#Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(H), data=ranch)
WA.Ecoli.models[[41]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[42]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(H), data=WA1)
WA.Ecoli.models[[43]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(H), data=WA1)
WA.Ecoli.models[[44]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(H), data=WA1)
WA.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(H), data=WA1)


#Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Rain_cm) +scale(Cl), data=ranch)
#Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_max)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+scale(Cl), data=ranch)

WA.Ecoli.models[[46]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[47]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[48]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm), data=WA1)
WA.Ecoli.models[[49]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm), data=WA1)


WA.Ecoli.models[[50]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm), data=WA1)
WA.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm), data=WA1)


WA.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean), data=WA1)
WA.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean), data=WA1)

WA.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max), data=WA1)




Mods.WA.Ecoli <- paste("model", 1:length(WA.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = WA.Ecoli.models, modnames = Mods.WA.Ecoli, sort = TRUE)

summary(WA.Ecoli.models[[7]])
summary(WA.Ecoli.models[[52]])

plot(E_coli_MPN~Rain_cm, data=WA1)
abline(lm(E_coli_MPN~Rain_cm, data=WA1))

plot(E_coli_MPN~Flow_min, data=WA1)
abline(lm(E_coli_MPN~Flow_min, data=WA1))
```


### 
#Tunnel Green
#####
```{r}
WCD<- Wheeling_Creek_Data_Copy[c(1:444),c(1:10,12:14,20:24)]
TG <- subset(WCD, WCD$Site == "Tunnel Green")


TG[complete.cases(TG), ] # Keep only the complete rows
TG1 <- TG[complete.cases(TG), ] # Store the complete cases subset in a new data frame

WV.ecoli <- lmer(E_coli_MPN ~ scale(DO) + 
                 scale(Temp) + 
                 scale(Turbidity) +
                 scale(Cl) +
                 scale(H) +
                 scale(Prev_rain_cm) +
                 scale(Rain_cm) +
                 scale(SPC) +
                 scale(Flow_mean) +
                 scale(Flow_max) + 
                 scale(Flow_min)
                 , data=ranch, na.action = "na.fail",
               control = lmerControl(optCtrl = list(maxfun=20000)))
mod50 <- dredge(resp50)
mod1_50 <- model.avg(get.models(mod50, subset = TRUE))
summary(mod1_50)

# need to check a stepVIF for Ranch Bar
ranchVIF <- data.frame(
                 scale(RB1$DO) + 
                 scale(RB1$Temp) + 
                 scale(RB1$Turbidity) +
                 scale(RB1$H) +
                 scale(RB1$Prev_rain_cm) +
                 scale(RB1$Rain_cm) +
                 scale(RB1$SPC) +
                 scale(RB1$Flow_mean) +
                 scale(RB1$Flow_max) + 
                 scale(RB1$Flow_min))
ranch.VIF<-stepVIF(ranchVIF, th=10)


# so the problem with this subset of models is that they are not all complete cases of variables

TG.Ecoli.models<-list()

#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Date), data=ranch)
#Ranch.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Month), data=ranch)
#Ranch.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(Season), data=ranch)
#Ranch.Ecoli.models[[1]]  <- lm( E_coli_MPN ~  1, data=RB1)
TG.Ecoli.models[[1]]  <- lm( E_coli_MPN ~ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[2]]  <- lm( E_coli_MPN ~ scale(Temp),data=TG1)
TG.Ecoli.models[[3]]  <- lm( E_coli_MPN ~ scale(DO), data=TG1)
TG.Ecoli.models[[4]]  <- lm( E_coli_MPN ~ scale(SPC), data=TG1)
TG.Ecoli.models[[5]]  <- lm( E_coli_MPN ~ scale(H), data=TG1)
#Ranch.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Cl)+ (1| Month), data=RB1, REML= FALSE)
TG.Ecoli.models[[6]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm), data=TG1)
TG.Ecoli.models[[7]]  <- lm( E_coli_MPN ~ scale(Rain_cm), data=TG1)
TG.Ecoli.models[[8]]  <- lm( E_coli_MPN ~ scale(Flow_mean), data=TG1)
TG.Ecoli.models[[9]]  <- lm( E_coli_MPN ~ scale(Flow_max), data=TG1)
TG.Ecoli.models[[10]]  <- lm( E_coli_MPN ~ scale(Flow_min), data=TG1)


TG.Ecoli.models[[11]]  <- lm( E_coli_MPN ~ scale(Temp)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[12]]  <- lm( E_coli_MPN ~ scale(DO)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[13]]  <- lm( E_coli_MPN ~ scale(SPC)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[14]]  <- lm( E_coli_MPN ~ scale(H)+ scale(Turbidity) , data=TG1)
#Ranch.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(Turbidity) , data=ranch)
TG.Ecoli.models[[15]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[16]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[17]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[18]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Turbidity) , data=TG1)
TG.Ecoli.models[[19]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Turbidity) , data=TG1)


TG.Ecoli.models[[20]]  <- lm( E_coli_MPN ~ scale(DO) + scale(Temp), data=TG1)
TG.Ecoli.models[[21]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(Temp) , data=TG1)
TG.Ecoli.models[[22]]  <- lm( E_coli_MPN ~ scale(H) + scale(Temp), data=TG1)
#Ranch.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(Temp), data=ranch)
TG.Ecoli.models[[23]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(Temp), data=TG1)
TG.Ecoli.models[[24]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Temp), data=TG1)
TG.Ecoli.models[[25]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Temp), data=TG1)
TG.Ecoli.models[[26]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Temp), data=TG1)
TG.Ecoli.models[[27]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Temp), data=TG1)


TG.Ecoli.models[[28]]  <- lm( E_coli_MPN ~ scale(SPC) + scale(DO), data=TG1)
TG.Ecoli.models[[29]]  <- lm( E_coli_MPN ~ scale(H) + scale(DO) , data=TG1)
#Ranch.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(DO) , data=ranch)
TG.Ecoli.models[[30]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(DO), data=TG1)
TG.Ecoli.models[[31]]  <- lm( E_coli_MPN ~ scale(Rain_cm) + scale(DO), data=TG1)
TG.Ecoli.models[[32]]  <- lm( E_coli_MPN ~ scale(Flow_mean) + scale(DO) , data=TG1)
TG.Ecoli.models[[33]]  <- lm( E_coli_MPN ~ scale(Flow_max) + scale(DO) , data=TG1)
TG.Ecoli.models[[34]]  <- lm( E_coli_MPN ~ scale(Flow_min) + scale(DO) , data=TG1)


TG.Ecoli.models[[35]]  <- lm( E_coli_MPN ~ scale(H)+ scale(SPC), data=TG1)
#Ranch.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Cl) + scale(SPC), data=ranch)
TG.Ecoli.models[[36]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm) + scale(SPC), data=TG1)
TG.Ecoli.models[[37]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(SPC), data=TG1)
TG.Ecoli.models[[38]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(SPC), data=TG1)
TG.Ecoli.models[[39]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(SPC), data=TG1)
TG.Ecoli.models[[40]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(SPC), data=TG1)


#Ranch.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Cl)+ scale(H), data=ranch)
TG.Ecoli.models[[41]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+ scale(H), data=TG1)
TG.Ecoli.models[[42]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(H), data=TG1)
TG.Ecoli.models[[43]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(H), data=TG1)
TG.Ecoli.models[[44]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(H), data=TG1)
TG.Ecoli.models[[45]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(H), data=TG1)


#Ranch.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Prev_rain_cm)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Rain_cm) +scale(Cl), data=ranch)
#Ranch.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_max)+scale(Cl), data=ranch)
#Ranch.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+scale(Cl), data=ranch)

TG.Ecoli.models[[46]]  <- lm( E_coli_MPN ~ scale(Rain_cm)+ scale(Prev_rain_cm), data=TG1)
TG.Ecoli.models[[47]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Prev_rain_cm), data=TG1)
TG.Ecoli.models[[48]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Prev_rain_cm), data=TG1)
TG.Ecoli.models[[49]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Prev_rain_cm), data=TG1)


TG.Ecoli.models[[50]]  <- lm( E_coli_MPN ~ scale(Flow_mean)+ scale(Rain_cm), data=TG1)
TG.Ecoli.models[[51]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Rain_cm), data=TG1)
TG.Ecoli.models[[52]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Rain_cm), data=TG1)


TG.Ecoli.models[[53]]  <- lm( E_coli_MPN ~ scale(Flow_max)+ scale(Flow_mean), data=TG1)
TG.Ecoli.models[[54]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_mean), data=TG1)

TG.Ecoli.models[[55]]  <- lm( E_coli_MPN ~ scale(Flow_min)+ scale(Flow_max), data=TG1)




Mods.TG.Ecoli <- paste("model", 1:length(TG.Ecoli.models), sep = " ")

##generate AICc table from candidate models so that you can control the model
aictab(cand.set = TG.Ecoli.models, modnames = Mods.TG.Ecoli, sort = TRUE)

summary(WA.Ecoli.models[[3]])
summary(WA.Ecoli.models[[52]])

plot(E_coli_MPN~Rain_cm, data=WA1)
abline(lm(E_coli_MPN~Rain_cm, data=WA1))

plot(E_coli_MPN~Flow_min, data=WA1)
abline(lm(E_coli_MPN~Flow_min, data=WA1))





###